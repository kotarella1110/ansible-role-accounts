---
- hosts: localhost
  remote_user: root
  vars:
    accounts_sudoers:
      - name: somegroup
        state: present
        who: "%somegroup"
        where: "ALL"
        as_whom: "ALL"
        what : "NOPASSWD: ALL" 
      - name: admins
        state: present
        who: "%admins"
        where: "ALL"
        as_whom: "ALL"
        what : "NOPASSWD: ALL" 
      - name: somegroup
        state: absent
    accounts_groups:
      - name: somegroup
      - name: admins
      - name: developers
      - name: somegroup
        state: absent
    accounts_users:
      - name: johnd
        comment: "John Doe"
        uid: 1040
        group: admin
      - name: james
        shell: /bin/bash
        groups:
          - admins
          - developers
        append: yes
      - name: johnd
        state: absent
        remove: yes
      - name: jsmith
        generate_ssh_key: yes
        ssh_key_bits: 2048
        ssh_key_file: .ssh/id_rsa
      - name: james18
        shell: /bin/zsh
        groups: developers
        expires: 1422403387
      - name: charlie
        authorized_keys:
          - key="{{ lookup('file', '/home/charlie/.ssh/id_rsa.pub') }}"
          - key=https://github.com/charlie.keys
          - key="{{ lookup('file', '/home/charlie/.ssh/id_rsa.pub') }}" state=absent
          - key: "{{ lookup('file', '/home/charlie/.ssh/id_rsa.pub') }}"
            path: "/etc/ssh/authorized_keys/charlie"
            manage_dir: no
          - key:  "{{ lookup('file', '/home/charlie/.ssh/id_rsa.pub') }}"
            key_options: 'no-port-forwarding,from="10.0.1.1"'
          - key=https://github.com/user.keys validate_certs=no
          - key="{{ lookup('file', lookup('env','HOME') + "/.ssh/id_rsa.pub") }}"
  roles:
    - kotarella1110.accounts